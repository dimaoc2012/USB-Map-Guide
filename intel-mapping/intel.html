
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Intel USB Mapping Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-medium-zoom/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    

    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../amd-mapping/amd.html" />
    
    
    <link rel="prev" href="../system-preparation.html" />
    

    <style>
    @media only screen and (max-width: 640px) {
        .book-header .hidden-mobile {
            display: none;
        }
    }
    </style>
    <script>
        window["gitbook-plugin-github-buttons"] = {"buttons":[{"user":"dortania","repo":"USB-Map-Guide","type":"star","size":"large"}]};
    </script>

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    USB Mapping
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../system-preparation.html">
            
                <a href="../system-preparation.html">
            
                    
                    System Preparation
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Intel Mapping</li>
        
        
    
        <li class="chapter active" data-level="2.1" data-path="intel.html">
            
                <a href="intel.html">
            
                    
                    Intel USB Mapping
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">AMD/3rd Party Mapping</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../amd-mapping/amd.html">
            
                <a href="../amd-mapping/amd.html">
            
                    
                    AMD and 3rd Party USB Mapping
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Miscellaneous Fixes</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../misc/">
            
                <a href="../misc/">
            
                    
                    Miscellaneous Fixes
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="../misc/power.html">
            
                <a href="../misc/power.html">
            
                    
                    Fixing USB Power
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="../misc/shutdown.html">
            
                <a href="../misc/shutdown.html">
            
                    
                    Fixing Shutdown/Restart
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3" data-path="../misc/instant-wake.html">
            
                <a href="../misc/instant-wake.html">
            
                    
                    GPRW/UPRW/LANC Instant Wake Patch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4" data-path="../misc/keyboard.html">
            
                <a href="../misc/keyboard.html">
            
                    
                    Keyboard Wake Issues
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Intel USB Mapping</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <blockquote>
<p><em>Last modified: Sat Jun 20 2020 16:54:40 GMT+0000 (Coordinated Universal Time)</em></p>
</blockquote>
<h1 id="usb-mapping"><a name="usb-mapping" class="plugin-anchor" href="#usb-mapping"><i class="fa fa-link" aria-hidden="true"></i></a>USB Mapping</h1>
<p>Table of Contents:</p>
<ul>
<li><a href="intel.html#intel-usb-mapping">Intel USB Mapping</a></li>
<li><a href="intel.html#removing-acpi-renames">Removing ACPI Renames</a></li>
</ul>
<p>So with the prerequisites out of the way, we can finally get to the meat of this guide. And now we get to finally read one of my favorite books before I go to bed each night: <a href="https://uefi.org/sites/default/files/resources/ACPI_6_3_final_Jan30.pdf" target="_blank">The Advanced Configuration and Power Interface (ACPI) Specification!</a></p>
<p>Now if you haven&apos;t read through this before(which I highly recommend you do, it&apos;s a thrilling tale), I&apos;ll point you to the meat of the USB situation:</p>
<ul>
<li>Section 9.14: _UPC (USB Port Capabilities)</li>
</ul>
<p>Here we&apos;re greeted with all the possible USB ports in ACPI:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Type</th>
<th style="text-align:left">Info</th>
<th style="text-align:left">Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:left">USB 2.0 Type-A connector</td>
<td style="text-align:left">This is what macOS will default all ports to when no map is present</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:left">USB 3.0 Type-A connector</td>
<td style="text-align:left">3.0, 3.1 and 3.2 ports share the same Type</td>
</tr>
<tr>
<td style="text-align:left">8</td>
<td style="text-align:left">Type C connector - USB 2.0-only</td>
<td style="text-align:left">Mainly seen in phones</td>
</tr>
<tr>
<td style="text-align:left">9</td>
<td style="text-align:left">Type C connector - USB 2.0 and USB 3.0 with Switch</td>
<td style="text-align:left">Flipping the device <strong>does not</strong> change the ACPI port</td>
</tr>
<tr>
<td style="text-align:left">10</td>
<td style="text-align:left">Type C connector - USB 2.0 and USB 3.0 without Switch</td>
<td style="text-align:left">Flipping the device <strong>does</strong> change the ACPI port. generally seen on 3.1/2 motherboard headers</td>
</tr>
<tr>
<td style="text-align:left">255</td>
<td style="text-align:left">Proprietary connector</td>
<td style="text-align:left">For Internal USB ports like Bluetooth</td>
</tr>
</tbody>
</table>
<h3 id="intel-usb-mapping"><a name="intel-usb-mapping" class="plugin-anchor" href="#intel-usb-mapping"><i class="fa fa-link" aria-hidden="true"></i></a>Intel USB Mapping</h3>
<p>USB mapping on Intel is super easy mainly because both the ACPI is sane and more tools available for the platform. For this guide well be using the <a href="https://github.com/corpnewt/USBMap" target="_blank">USBmap tool</a> from CorpNewt.</p>
<p>Now open up USBmap.command and select <code>D.  Discover Ports</code>:</p>
<p><img src="../images/post-install/usb-md/usb-map-start.png" alt="">
<img src="../images/post-install/usb-md/mapping.png" alt=""></p>
<p>The interface for USBmap is quite simple and easy to grasp so won&apos;t go into detail here, the <a href="https://github.com/corpnewt/USBMap" target="_blank">README.md</a> should do you well enough. The basic idea is insert a device, give it a name to remember the port by, remove and then try another port unti you have a whole list of ports you want to keep.</p>
<p>Once you&apos;re done discovering your ports, select <code>Press Q then [enter] to stop</code> then head to <code>P.  Edit Plist &amp; Create SSDT/Kext</code> from the main menu.</p>
<p>For this example, I&apos;ll choose all the ports that were discovered, remember that there is a 15 port limit so you <strong>cannot</strong> go over it. USB hubs will count as one USB port so you can expand from there is you are limited on ports.</p>
<p><img src="../images/post-install/usb-md/255.png" alt=""></p>
<pre><code class="lang-text">T:1,3,4,5,6,716,17,19,21,22:3
</code></pre>
<p>The above will set all ports listed to type 3 which is USB 3.0.</p>
<pre><code class="lang-text">T:9:255
</code></pre>
<p>This will set my Bluetooth to internal, this is super important as macOS expects Bluetooth to always be internal.</p>
<p><img src="../images/post-install/usb-md/build-map.png" alt=""></p>
<p>Now we can select <code>K. Build USBMap.kext</code> and let it build our kext for us.</p>
<p><strong>Note</strong>: Do not use either the SSDT-UIAC.aml <strong>or</strong> USBInjectAll with the USBmap.kext. This kext we just made should be used by itself with no other USB kexts besides XhciUnsupported if your system needs it. Reason for this is USBInjectAll is no longer being maintained and the USBmap.kext version is how real Macs USB map as well so as close to &quot;Apple Like&quot; as possible to fit the OpenCore mood.</p>
<p>Now reboot and run USBmap again, you should see a lot less ports in your map:</p>
<p><img src="../images/post-install/usb-md/usb-done.png" alt=""></p>
<h4 id="removing-acpi-renames"><a name="removing-acpi-renames" class="plugin-anchor" href="#removing-acpi-renames"><i class="fa fa-link" aria-hidden="true"></i></a>Removing ACPI Renames</h4>
<p>Now once you&apos;ve mapped your USB ports, we can finally remove those pesky ACPI renames. USBmap.command will have made the kext with the renamed controllers so we&apos;re going to have to change them back to the proper names to avoid any headaches when booting Windows or Linux.</p>
<ul>
<li><strong>Note</strong>: In macOS Catalina 10.15, overriding Apple&apos;s port maps can fail for some users. In these situations, you will need to remove your ACPI renames.</li>
</ul>
<p>To start, right click the kext and select <code>Show Package Contents</code>, then head to <code>Contents -&gt; Info.plist</code></p>
<p><img src="../images/post-install/usb-md/remove-rename.png" alt=""></p>
<p>And you&apos;ll want to rename the <code>IONameMatch</code> value to your unpatched controller&apos;s name:</p>
<ul>
<li>SHCI -&gt; XHC1</li>
<li>EH01 -&gt; EHC1</li>
<li>EH02 -&gt; EHC2</li>
</ul>
<p>And once that&apos;s done, you&apos;ll next want to head to your config.plist and disable the ACPI patches</p>
<ul>
<li>ACPI -&gt; Patch -&gt; Enabled -&gt; False</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../system-preparation.html" class="navigation navigation-prev " aria-label="Previous page: System Preparation">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../amd-mapping/amd.html" class="navigation navigation-next " aria-label="Next page: AMD and 3rd Party USB Mapping">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Intel USB Mapping","level":"2.1","depth":1,"next":{"title":"AMD and 3rd Party USB Mapping","level":"3.1","depth":1,"path":"amd-mapping/amd.md","ref":"amd-mapping/amd.md","articles":[]},"previous":{"title":"System Preparation","level":"1.2","depth":1,"path":"system-preparation.md","ref":"system-preparation.md","articles":[]},"dir":"ltr"},"config":{"plugins":["theme-default","-lunr","-search","search-plus","addcssjs","favicon-plus","anchors","github-buttons","last-modified","medium-zoom"],"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"},"pluginsConfig":{"last-modified":{},"output":"_book","intopic-toc":{"label":"Navigation"},"addcssjs":{"css":[],"js":[]},"medium-zoom":{},"fontsettings":{"theme":"night","family":"sans","size":2},"favicon-plus":{"appleTouchIconPrecomposed152":"","favicon":"","output":"_book"},"highlight":{},"github-edit":{"repo":"dortania/USB-Map-Guide","branch":"master"},"favicon":"/icons/favicon.ico","appleTouchIconPrecomposed152":"/icons/appleTouchIconPrecomposed152.png","github-buttons":{"buttons":[{"user":"dortania","repo":"USB-Map-Guide","type":"star","size":"large"}]},"sharing":{"facebook":false,"twitter":false,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":[]},"theme-default":{"showLevel":false,"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"}},"anchors":{},"search-plus":{}},"theme":"default","medium-zoom":{"margin":24,"background":"#363b40","scrollOffset":0},"pdf":{"pageBreaksBefore":"/","headerTemplate":null,"paperSize":"a4","margin":{"right":62,"left":62,"top":36,"bottom":36},"fontSize":12,"fontFamily":"Arial","footerTemplate":null,"chapterMark":"pagebreak","pageNumbers":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"links":{"sharing":{"google":false,"facebook":false,"twitter":false,"weibo":false,"all":false}},"gitbook":"*"},"file":{"path":"intel-mapping/intel.md","mtime":"2020-06-20T16:54:40.244Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-06-20T16:55:36.612Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github-buttons/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-medium-zoom/medium-zoom.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-medium-zoom/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    

    </body>
</html>

